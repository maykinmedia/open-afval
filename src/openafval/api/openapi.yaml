openapi: 3.0.3
info:
  title: Open Afval
  version: 0.0.1
paths:
  /api/v1/afval-profiel/{bsn}/:
    get:
      operationId: afvalProfielRetrieve
      description: Returns the complete afval profiel for a specific klant. This is
        a detail view returning a single profiel object with summary statistics, all
        containers, all container locations, and ledigingen.
      summary: Retrieve afval profiel for a klant by BSN
      parameters:
      - in: path
        name: bsn
        schema:
          type: string
          pattern: ^[0-9]{8,9}$
        required: true
      tags:
      - Afval profiel
      security:
      - tokenAuth: []
      responses:
        '200':
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AfvalProfiel'
          description: ''
        '404':
          description: No response body
components:
  schemas:
    AfvalProfiel:
      type: object
      description: Serializer for the complete 'Afval profiel' for a klant
      properties:
        klant:
          allOf:
          - $ref: '#/components/schemas/Klant'
          readOnly: true
        summary:
          allOf:
          - $ref: '#/components/schemas/Summary'
          readOnly: true
        containers:
          type: array
          items:
            $ref: '#/components/schemas/Container'
          readOnly: true
        containerLocaties:
          type: array
          items:
            $ref: '#/components/schemas/ContainerLocation'
          readOnly: true
        ledigingen:
          type: array
          items:
            $ref: '#/components/schemas/Lediging'
          readOnly: true
      required:
      - containerLocaties
      - containers
      - klant
      - ledigingen
      - summary
    AfvalTypeEnum:
      enum:
      - gft
      - restafval
      type: string
      description: |-
        * `gft` - Groente, Fruit en Tuin afval (GFT)
        * `restafval` - Rest afval (Rest)
    Container:
      type: object
      description: Container serializer with aggregated weight for specific BSN
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
        afvalType:
          allOf:
          - $ref: '#/components/schemas/AfvalTypeEnum'
          readOnly: true
          title: Afvaltype
          description: |-
            Het type afval dat de container bevat

            * `gft` - Groente, Fruit en Tuin afval (GFT)
            * `restafval` - Rest afval (Rest)
        isVerzamelcontainer:
          type: boolean
          readOnly: true
          description: Of de container een verzamelcontainer is.
        heeftSleutel:
          type: boolean
          readOnly: true
          description: Of de container een sleutel heeft.
        totaalGewicht:
          type: number
          format: double
          readOnly: true
      required:
      - afvalType
      - heeftSleutel
      - id
      - isVerzamelcontainer
      - totaalGewicht
    ContainerLocation:
      type: object
      description: Container location serializer with aggregated weight for specific
        BSN
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
        adres:
          type: string
          readOnly: true
          description: Het adres van een afval container.
        totaalGewicht:
          type: number
          format: double
          readOnly: true
      required:
      - adres
      - id
      - totaalGewicht
    Klant:
      type: object
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
        bsn:
          type: string
          readOnly: true
          description: De BSN van de klant.
        naam:
          type: string
          readOnly: true
          description: De naam van de klant, dit kan een persoon, organisatie, bedrijf,
            etc. zijn.
      required:
      - bsn
      - id
      - naam
    Lediging:
      type: object
      description: Lediging serializer with ID references for related objects
      properties:
        id:
          type: string
          format: uuid
          readOnly: true
        containerLocation:
          type: string
          format: uuid
          readOnly: true
        klant:
          type: string
          format: uuid
          readOnly: true
        container:
          type: string
          format: uuid
          readOnly: true
          description: De container die geleegd is.
        gewicht:
          type: number
          format: double
          readOnly: true
          description: De gewicht van de lediging.
        geleegdOp:
          type: string
          format: date-time
          readOnly: true
          description: De datum en tijd van de lediging.
      required:
      - container
      - containerLocation
      - geleegdOp
      - gewicht
      - id
      - klant
    Periode:
      type: object
      description: Serializer for the period of ledigingen.
      properties:
        eersteLediging:
          type: string
          format: date-time
        laatsteLediging:
          type: string
          format: date-time
      required:
      - eersteLediging
      - laatsteLediging
    Summary:
      type: object
      description: Serializer for summary statistics.
      properties:
        totaalGewicht:
          type: number
          format: double
        totaalGewichtPerAfvalType:
          type: object
          additionalProperties: {}
        aantalLedigingen:
          type: integer
        aantalContainers:
          type: integer
        aantalContainerLocaties:
          type: integer
        periode:
          allOf:
          - $ref: '#/components/schemas/Periode'
          nullable: true
      required:
      - aantalContainerLocaties
      - aantalContainers
      - aantalLedigingen
      - periode
      - totaalGewicht
      - totaalGewichtPerAfvalType
  securitySchemes:
    tokenAuth:
      type: apiKey
      in: header
      name: Authorization
      description: Token-based authentication with required prefix "Token"
